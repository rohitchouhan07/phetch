#!/bin/sh
# A newbies attempt at a status posix script, a lot needs to be learnt and improved

#getting all the useful information

#get host name
hostname=$HOSTNAME

#get OS name
#sourcing the file for easily getting the distribution name
. /etc/os-release
os=$PRETTY_NAME

#get shell
shell=$SHELL

#get RAM usage
mem=$(free -m | awk '/^Mem/ {print $3"M / "$2"M"}') 

#get packages installed (thanks to nerdfetch for this implementation)
pkgs=$(which nix-env yum dnf rpm apt brew port zypper pacman xbps-query pkg emerge cave apk kiss brl yay cpm eopkg 2>/dev/null)
pkgs=${pkgs##*/}
case $pkgs in
	cpm) packages="$(cpm C)";;
	brew) packages="$(brew list --formula | wc -l)";;
	port) packages="$(port installed | tot)";;
	apt) packages="$(dpkg-query -f '${binary:Package}\n' -W | wc -l)";;
	rpm) packages="$(rpm -qa --last| wc -l)";;
	yum) packages="$(yum list installed | wc -l)";;
	dnf) packages="$(dnf list installed | wc -l)";;
	zypper) packages="$(zypper se | wc -l)";;
	pacman) packages="$(pacman -Q | wc -l)";;
	yay) packages="$(yay -Q | wc -l)";;
	kiss) packages="$(kiss list | wc -l)";;
	pkg|emerge) packages="$(qlist -I | wc -l)";;
	cave) packages="$(cave show installed-slots | wc -l)";;
	xbps-query) packages="$(xbps-query -l | wc -l)";;
	nix-env) packages="$(nix-store -q --requisites /run/current-system/sw | wc -l)";;
	apk) packages="$(apk list --installed | wc -l)";;
	brl) packages="$(brl list | wc -l)";;
	eopkg) packages="$(eopkg li | wc -l)";;
	*) packages="idk"
esac

#get kernel version
kernel=$(uname -r)

#get uptime
time=$(uptime -p)
time="${time##up}"

#define colors (thanks to nerdfetch and ufetch)

bold='[1m'
black='[30m'
red='[31m'
green='[32m'
yellow='[33m'
blue='[34m'
magenta='[35m'
cyan='[36m'
white='[37m'
grey='[90m'
reset='[0m'

art=3

#printing the ascii art

cat <<-EOF
 ${yellow}|\/\/\/|${reset}
 ${yellow}|      |${reset}   ${blue}OS${reset}     $os
 ${yellow}|      |${reset}   ${blue}host${reset}   $hostname
 ${yellow}| (o)(o)${reset}   ${blue}shell${reset}  ${shell##*/}
 ${yellow}C      _)${reset}  ${blue}pkgs${reset}   $packages
 ${yellow} | ,___|${reset}   ${blue}kernel${reset} $kernel
 ${yellow} |   /${reset}     ${blue}memory${reset} $mem
 ${yellow}/____\\${reset}     ${blue}uptime${reset} ${time#${time%%[![:space:]]*}}
${yellow}/      \\${reset}
		
EOF

#printing all the data here, comment out the ones you don't need   
#printf '%s\n' "${blue}OS${reset}     $os"
#printf '%s\n' "${blue}host${reset}   $hostname"
#printf '%s\n' "${blue}shell${reset}  ${shell##*/}" 
#printf '%s\n' "${blue}pkgs${reset}   $packages"
#printf '%s\n' "${blue}kernel${reset} $kernel"
#printf '%s\n' "${blue}memory${reset} $mem"
#printf '%s\n' "${blue}uptime${reset} ${time#${time%%[![:space:]]*}}"
#printf "\n"
